@if (!data.deleted) {
  <div class="publicacion">
    <div class="publicacion-header">
      @if (data.userPhoto) {
        <img [src]="data.userPhoto" alt="Foto de usuario" class="foto-usuario">
      }
      <span class="usuario-nombre">{{data.userName}}</span>
      <span class="fecha">{{data.date | date:'short'}} </span>
      @if (isMyPost()) {
        <button (click)="deletePost()">Eliminar</button>
      }
    </div>
    <div class="publicacion-contenido">
      <p>{{data.content}}</p>
      @if (data.images && data.images.length > 0) {
        <div class="imagenes-grid">
          @for (imagen of data.images; track imagen) {
            <div class="imagen-container">
              <img [src]="imagen" alt="Imagen de publicación" class="imagen-publicacion" (load)="onImageLoad($event)" (error)="onImageError($event)">
              <div class="imagen-loading">
                <div class="spinner"></div>
              </div>
            </div>
          }
        </div>
      }
    </div>
    <div class="publicacion-footer">
      @if (data.liked === true) {
        <button (click)="unlike()">Quitar me gusta</button>
      } @else {
        <button (click)="like()">Me gusta</button>
      }
      <span>{{data.likesCount}} me gusta</span>
    </div>
    <div class="comentarios">
      @for (comment of data.comments; track comment) {
        <app-comentario [data]="comment"></app-comentario>
      }
      <form (submit)="onAddComment($event, commentInput)">
        <input #commentInput type="text" name="content" placeholder="Agregar comentario..." required>
        <button type="submit">Comentar</button>
      </form>
    </div>
    <div class="publicacion-expandida" *ngIf="expandida">
      <img *ngIf="data.imageUrl" [src]="data.imageUrl" alt="Imagen de la publicación">
      <div class="comentarios">
        <div *ngFor="let comentario of data.comments">
          <p>{{comentario.content}}</p>
          <small *ngIf="comentario.modified">(Editado)</small>
        </div>
        <button (click)="cargarMasComentarios()">Cargar más</button>
      </div>
    </div>
  </div>
}
